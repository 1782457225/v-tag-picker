(function(t){function e(e){for(var n,s,l=e[0],r=e[1],c=e[2],h=0,p=[];h<l.length;h++)s=l[h],a[s]&&p.push(a[s][0]),a[s]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,l=1;l<i.length;l++){var r=i[l];0!==a[r]&&(n=!1)}n&&(o.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},a={index:0},o=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var u=r;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("c31f")},"0e2a":function(t,e,i){t.exports=i.p+"img/tagbg.e4ba97b5.png"},"2e4f":function(t,e,i){"use strict";var n=i("5b00"),a=i.n(n);a.a},3006:function(t,e,i){},"59a4":function(t,e,i){"use strict";var n=i("3006"),a=i.n(n);a.a},"5b00":function(t,e,i){},"5e45":function(t,e,i){},c31f:function(t,e,i){"use strict";i.r(e);var n=i("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("v-tag-picker",{attrs:{totalData:t.tagData,multipleSelection:t.multipleSelection},on:{change:t.change}},[n("div",{staticClass:"img-wrap",attrs:{slot:"top"},slot:"top"},[n("img",{attrs:{src:i("0e2a"),alt:""}}),n("div",{staticClass:"img-wrap__title"},[t._v("最感兴趣的栏目")]),n("div",{staticClass:"img-wrap__subtitle"},[t._v("定制专属于我的课程栏目")])]),n("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[n("a",{attrs:{href:"/"}},[t._v("进入首页")])])])],1)},o=[],s=i("bc3a"),l=i.n(s),r={name:"app",components:{},data(){return{tagData:[],multipleSelection:[]}},methods:{change(t){}},mounted(){l.a.get("http://yapi.demo.qunar.com/mock/60654/tag").then(t=>{this.tagData=t.data.data}),l.a.get("http://yapi.demo.qunar.com/mock/60654/selection").then(t=>{this.multipleSelection=t.data.data})}},c=r,u=(i("e780"),i("2877")),h=Object(u["a"])(c,a,o,!1,null,null,null),p=h.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"vtag-wrap",staticClass:"vtag-wrap",style:{"z-index":t.zIndex}},[i("div",{ref:"top",staticClass:"vtag-top"},[i("div",{ref:"top-content",staticClass:"vtag-top__content",style:t.vtagTopContentStyle,on:{click:function(e){t.handleCancelVtag(e)},scroll:t.topScroll}},[t._l(t.selection,function(e,n){return i("VTagPickerItem",{key:n,staticClass:"vtag-top__item",style:{transition:"all "+t.animationDuration/1e3+"s"},attrs:{type:"light",name:e.name,totalSelectionKey:e[t.OnlyKey]}})}),i("div",{staticClass:"vtag-top-content__width",style:{width:t.vtopContentWidth,height:"1px"}})],2),t.showTagNum?i("div",{staticClass:"vtag-top__right"},[i("div",{staticClass:"vtag-top__num"},[t._v(t._s("+"+t.rightTagNum))])]):t._e()]),t._t("top"),i("div",{ref:"container",staticClass:"vtag-container"},[i("div",{staticClass:"vtag-container__content"},t._l(t.totalData,function(e,n){return i("VTagPickerItem",{key:n,staticClass:"vtag-container__item",style:{transition:"all "+t.animationDuration/1e3+"s",animationDuration:t.animationDuration/1e3+"s"},attrs:{name:e.name},on:{click:function(i){t.handleClickVtag(i,e)}}})}),1)]),i("div",{ref:"vtag-footer",staticClass:"vtag-footer"},[t._t("footer")],2)],2)},g=[];const m=(t,e,i)=>{let n,a=new Date;return function(){let o=this,s=Array.prototype.slice.call(arguments),l=new Date;clearTimeout(n),l-a>=i?(t.apply(o,s),a=l):n=setTimeout(function(){t.apply(o,s)},e)}},f=(t,e)=>{let i=null;return function(){let n=this,a=Array.prototype.slice.call(arguments);clearTimeout(i),i=setTimeout(function(){t.apply(n,a)},e)}},y=t=>{return new Promise(e=>{setTimeout(()=>{e()},t)})};var v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vtag-item",class:["vtag-item-"+t.type],attrs:{"totalSelection-key":t.totalSelectionKey},on:{click:t.handleClickVtag}},[t._v("\n  "+t._s(t.name)+"\n")])},S=[],b={name:"VTagPickerItem",props:{totalSelectionKey:{type:String},name:{type:String,required:!0},type:{type:String,default:"default"}},data(){return{}},methods:{handleClickVtag(t){this.$emit("click",t)}}},x=b,T=(i("2e4f"),Object(u["a"])(x,v,S,!1,null,"4f9df60e",null)),w=T.exports,C={name:"VTagPicker",components:{VTagPickerItem:w},props:{zIndex:Number,totalData:{type:Array,default:()=>[]},multipleSelection:{type:Array,default:()=>[]},animationDuration:{type:Number,default:500},OnlyKey:{type:String,default:"name"}},data(){return{rightTagNum:0,vtagTopContentStyle:{},showTagNum:!1,selection:[],domQueue:[],animating:!1,totalSelection:[],vtopContentWidth:"100%",debounceResetContentTag:f(this.resetContentTag,1.5*this.animationDuration),topScroll:m(this.computedTagNumShow,100,200),hasSelectionDom:[],topVtagItemCache:null}},watch:{multipleSelection:{handler(t){this.selection=JSON.parse(JSON.stringify(t)),this.totalSelection=JSON.parse(JSON.stringify(t)),this.$nextTick(()=>{this.computedTagNumShow(),this.initTagPosition()})},immediate:!0},totalSelection(t){this.$emit("change",JSON.parse(JSON.stringify(t)))},totalData:{handler(t){this.$nextTick(()=>{this.computedContainerHeight()})},immediate:!0}},methods:{handleCancelVtag(t){let e=t.target,i=e.offsetWidth;if(e.classList.contains("vtag-item-default")||!e.classList.contains("vtag-item"))return;e.classList.remove("vtag-item-light"),e.classList.add("vtag-item-default");let n=this.totalSelection.findIndex(t=>t[this.OnlyKey]===e.getAttribute("totalSelection-key"));this.totalData.push(this.totalSelection[n]),this.totalSelection.splice(n,1),e.innerHTML="";let a=e;while(a.nextElementSibling&&a.nextElementSibling.classList.contains("vtag-item")){let t=a.nextElementSibling,e=Number(t.getAttribute("transform-x"))-i-15;t.setAttribute("transform-x",e),t.style.transform=`translate(${e}px, 0)`,a=t}e.parentNode.removeChild(e),this.computedTagNumShow()},handleClickVtag(t,e){t.target.classList.contains("vtag-item-light")||(t.target.classList.add("animate"),t.target.classList.add("vtag-item-light"),this.totalSelection.push(e),this.domQueue.push({event:t,data:e}),setTimeout(()=>{if(t.target.classList.remove("animate"),this.animating)return;let e=this.domQueue.shift();this.moveTag(e.event,e.data)},this.animationDuration))},async moveTag(t,e){this.animating=!0;let i=t.target,n=t.target.cloneNode(!0),a=i.getBoundingClientRect(),o=this.$refs["vtag-wrap"],s=this.$refs["top-content"];s.scrollLeft=0,n.style.position="fixed",n.style.left=`${a.x}px`,n.style.top=`${a.y}px`,o.appendChild(n),i.style.width=`${i.offsetWidth}px`,i.style.height=`${i.offsetHeight}px`,i.style.background="transparent",i.innerHTML="",await y(10),this.moveExist(t),n.style.transform=`translate(${15-a.x}px,${10-a.y}px)`,setTimeout(()=>{if(this.hasSelectionDom.push(i),this.debounceResetContentTag(),n.parentNode.removeChild(n),this.topPrepend(t,e),this.animating=!1,this.computedTagNumShow(),this.domQueue.length){let t=this.domQueue.shift();this.moveTag(t.event,t.data)}},this.animationDuration)},moveExist(t){let e=t.target,i=e.offsetWidth,n=this.$refs["top-content"].querySelectorAll(".vtag-item");n.forEach(t=>{let e=Number(t.getAttribute("transform-x"))+i+15;t.setAttribute("transform-x",e),t.style.transform=`translate(${e}px, 0)`})},topPrepend(t,e){let i=this.$refs["top-content"];if(this.selection.length){let t=this.topVtagItemCache.cloneNode(!0);t.setAttribute("totalSelection-key",e[this.OnlyKey]),t.innerHTML=e.name,i.prepend(t)}else this.selection.unshift(e),this.$nextTick(()=>{i.querySelector(".vtag-item").setAttribute("totalSelection-key",e[this.OnlyKey]),this.topVtagItemCache=i.querySelector(".vtag-item").cloneNode(!0)})},initTagPosition(){let t=this.$refs["top-content"].querySelectorAll(".vtag-item");t.length&&(this.topVtagItemCache=t[0].cloneNode(!0)),t.forEach((e,i)=>{e.setAttribute("transform-x",0),e.style.transform="translate(0px, 0)",e.style.left=0===i?"15px":`${t[i-1].offsetLeft+t[i-1].offsetWidth+15}px`})},computedTagNumShow(){const t=this.$refs["top-content"];if(t.scrollWidth===t.clientWidth)this.showTagNum=!1,this.$set(this.vtagTopContentStyle,"width","100%"),this.$set(this.vtagTopContentStyle,"paddingRight","15px");else{this.showTagNum=!0;let t=this.$refs["top-content"],e=t.querySelectorAll(".vtag-item"),i=e[e.length-1],n=i.getBoundingClientRect();this.$set(this.vtagTopContentStyle,"paddingRight","94px"),this.vtopContentWidth=`${i.offsetLeft+Number(i.getAttribute("transform-x"))+n.width+Number(t.style.paddingLeft)+94}px`,this.rightTagNum=0,e.forEach(e=>{let i=e.getBoundingClientRect(),n=window.getComputedStyle(t);i.left+i.width>t.clientWidth-Number(n.paddingLeft.replace("px",""))-Number(n.paddingRight.replace("px",""))&&this.rightTagNum++})}},computedContainerHeight(){const t=this.$refs["vtag-wrap"],e=this.$refs.container,i=this.$refs["vtag-footer"];e.style.height=`${t.offsetHeight-e.offsetTop-(i.offsetHeight||0)}px`},resetContentTag(){this.hasSelectionDom.forEach(t=>{t.classList.add("hide")})}},mounted(){this.bodyStyle=document.body.style,document.body.style=`${this.bodyStyle}overflow: hidden;`},beforeDestroy(){document.body.style=this.bodyStyle}},_=C,$=(i("59a4"),Object(u["a"])(_,d,g,!1,null,"6c66d49e",null)),N=$.exports;N.install=function(t){t.component(N.name,N)};var k=N;const O=[k],D=function(t){D.installed||O.map(e=>t.component(e.name,e))};"undefined"!==typeof window&&window.Vue&&D(window.Vue);var L={install:D,tagPicker:k};n["a"].use(L),n["a"].config.productionTip=!1,new n["a"]({render:t=>t(p)}).$mount("#app")},e780:function(t,e,i){"use strict";var n=i("5e45"),a=i.n(n);a.a}});
//# sourceMappingURL=index.df224ece.js.map